# Define a memory channel called main-channel on kaki-agent

kaki-agent.channels.channel-raw.type = memory
kaki-agent.channels.channel-processed.type = memory

### ---------- raw data ----------
 
# twiter source
kaki-agent.sources.twitter-src.type = org.aprestos.labs.data.flume.sources.TwitterSource
kaki-agent.sources.twitter-src.channels = channel-raw
kaki-agent.sources.twitter-src.consumerKey = 0hH6ntFnAjA7nhpHBhIRA
kaki-agent.sources.twitter-src.accessToken = 52205623-qF6Cr429crkMDpDyZCWj7bVWMIVutCAobOWyFOvIO
kaki-agent.sources.twitter-src.maxBatchSize = 10
kaki-agent.sources.twitter-src.maxBatchDurationMillis = 1000
kaki-agent.sources.twitter-src.keywords = amazon, ibm, tesla, Bango
# going to append these lines in real time
###########################################################################################
#kaki-agent.sources.twitter-src.consumerSecret = XPTO <= added by a script on deploy
#kaki-agent.sources.twitter-src.accessTokenSecret = XPTO <= added by a script on deploy
###########################################################################################

# tickers source
kaki-agent.sources.tickers-src.type = org.aprestos.labs.data.flume.sources.tickers.realtime.Tickers
kaki-agent.sources.tickers-src.channels = channel-raw
kaki-agent.sources.tickers-src.delayInMillis = 60000
kaki-agent.sources.tickers-src.interval = 1min
kaki-agent.sources.tickers-src.tickers = AMZN, IBM, TSLA
###########################################################################################
#kaki-agent.sources.tickers-src.apikey = XPTO <= added by a script on deploy
###########################################################################################


# kafka sink
kaki-agent.sinks.twitter-kafka-sink.type = org.apache.flume.sink.kafka.KafkaSink
kaki-agent.sinks.twitter-kafka-sink.kafka.bootstrap.servers = kafka:9092
kaki-agent.sinks.twitter-kafka-sink.kafka.topic = tweets
kaki-agent.sinks.twitter-kafka-sink.kafka.flumeBatchSize = 6
kaki-agent.sinks.twitter-kafka-sink.kafka.producer.acks = 1
#kaki-agent.sinks.twitter-kafka-sink.kafka.producer.linger.ms = 1
#kaki-agent.sinks.twitter-kafka-sink.kafka.producer.compression.type = snappy
kaki-agent.sinks.twitter-kafka-sink.channel = channel-raw


### ---------- processed data from kafka-streams ----------

# kafka source
kaki-agent.sources.kafka-source.type = org.apache.flume.source.kafka.KafkaSource
kaki-agent.sources.kafka-source.channels = channel-processed
kaki-agent.sources.kafka-source.batchSize = 10
kaki-agent.sources.kafka-source.batchDurationMillis = 1000
kaki-agent.sources.kafka-source.kafka.bootstrap.servers = kafka:9092
kaki-agent.sources.kafka-source.kafka.topics = tweets-processed

# influxdb sink
kaki-agent.sinks.influxdb-sink.type = org.aprestos.labs.data.flume.sinks.influxdb.InfluxDbSink
kaki-agent.sinks.influxdb-sink.dbHost = kaki-influxdb
kaki-agent.sinks.influxdb-sink.dbPort = 8086
kaki-agent.sinks.influxdb-sink.dbUser = root
kaki-agent.sinks.influxdb-sink.dbPswd = password
kaki-agent.sinks.influxdb-sink.dbName = kaki
kaki-agent.sinks.influxdb-sink.channel = channel-processed

### --------------------

# file sink to debug purposes
#kaki-agent.sinks.twitter-file-sink.type = file_roll
#kaki-agent.sinks.twitter-file-sink.channel = channel-processed
#kaki-agent.sinks.twitter-file-sink.sink.directory = /var/log/flume

### --------------------
 
# Finally, now that we've defined all of our components, tell
# the agent which ones we want to activate.
kaki-agent.channels = channel-processed channel-raw
kaki-agent.sources = kafka-source tickers-src
kaki-agent.sinks = influxdb-sink twitter-kafka-sink
